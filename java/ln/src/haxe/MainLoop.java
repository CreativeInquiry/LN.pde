// Generated by Haxe 4.1.3
package haxe;

import haxe.root.*;

@SuppressWarnings(value={"rawtypes", "unchecked"})
public class MainLoop extends haxe.lang.HxObject
{
	public MainLoop(haxe.lang.EmptyObject empty)
	{
	}
	
	
	public MainLoop()
	{
		//line 58 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainLoop.__hx_ctor_haxe_MainLoop(this);
	}
	
	
	protected static void __hx_ctor_haxe_MainLoop(haxe.MainLoop __hx_this)
	{
	}
	
	
	public static haxe.MainEvent pending;
	
	public static boolean hasEvents()
	{
		//line 67 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent p = haxe.MainLoop.pending;
		//line 68 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		while (( p != null ))
		{
			//line 69 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			if (p.isBlocking) 
			{
				//line 70 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				return true;
			}
			
			//line 71 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			p = p.next;
		}
		
		//line 73 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		return false;
	}
	
	
	public static void sortEvents()
	{
		//line 103 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent list = haxe.MainLoop.pending;
		//line 105 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		if (( list == null )) 
		{
			//line 106 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			return ;
		}
		
		//line 108 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		int insize = 1;
		//line 108 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		int nmerges = 0;
		//line 108 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		int psize = 0;
		//line 108 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		int qsize = 0;
		//line 109 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent p = null;
		//line 109 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent q = null;
		//line 109 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent e = null;
		//line 109 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent tail = null;
		//line 111 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		while (true)
		{
			//line 112 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			p = list;
			//line 113 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			list = null;
			//line 114 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			tail = null;
			//line 115 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			nmerges = 0;
			//line 116 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			while (( p != null ))
			{
				//line 117 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				 ++ nmerges;
				//line 118 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				q = p;
				//line 119 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				psize = 0;
				//line 120 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				{
					//line 120 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					int _g = 0;
					//line 120 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					int _g1 = insize;
					//line 120 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					while (( _g < _g1 ))
					{
						//line 120 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						int i = _g++;
						//line 121 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						 ++ psize;
						//line 122 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						q = q.next;
						//line 123 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						if (( q == null )) 
						{
							//line 124 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							break;
						}
						
					}
					
				}
				
				//line 126 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				qsize = insize;
				//line 127 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				while (( ( psize > 0 ) || ( ( qsize > 0 ) && ( q != null ) ) ))
				{
					//line 128 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					if (( psize == 0 )) 
					{
						//line 129 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						e = q;
						//line 130 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						q = q.next;
						//line 131 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						 -- qsize;
					}
					else
					{
						//line 132 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						if (( ( ( qsize == 0 ) || ( q == null ) ) || (( ( p.priority > q.priority ) || ( ( p.priority == q.priority ) && ( p.nextRun <= q.nextRun ) ) )) )) 
						{
							//line 135 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							e = p;
							//line 136 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							p = p.next;
							//line 137 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							 -- psize;
						}
						else
						{
							//line 139 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							e = q;
							//line 140 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							q = q.next;
							//line 141 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
							 -- qsize;
						}
						
					}
					
					//line 143 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					if (( tail != null )) 
					{
						//line 144 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						tail.next = e;
					}
					else
					{
						//line 146 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
						list = e;
					}
					
					//line 147 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					e.prev = tail;
					//line 148 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					tail = e;
				}
				
				//line 150 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				p = q;
			}
			
			//line 152 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			tail.next = null;
			//line 153 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			if (( nmerges <= 1 )) 
			{
				//line 154 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				break;
			}
			
			//line 155 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			insize *= 2;
		}
		
		//line 157 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		list.prev = null;
		//line 158 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainLoop.pending = list;
	}
	
	
	public static double tick()
	{
		//line 165 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainLoop.sortEvents();
		//line 166 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		haxe.MainEvent e = haxe.MainLoop.pending;
		//line 167 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		double now = haxe.root.Sys.time();
		//line 168 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		double wait = 1e9;
		//line 169 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		while (( e != null ))
		{
			//line 170 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			haxe.MainEvent next = e.next;
			//line 171 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			double wt = ( e.nextRun - now );
			//line 172 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			if (( wt <= 0 )) 
			{
				//line 173 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				wait = ((double) (0) );
				//line 174 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				if (( e.f != null )) 
				{
					//line 174 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					e.f.__hx_invoke0_o();
				}
				
			}
			else
			{
				//line 175 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
				if (( wait > wt )) 
				{
					//line 176 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
					wait = wt;
				}
				
			}
			
			//line 177 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
			e = next;
		}
		
		//line 179 "/usr/local/lib/haxe/std/haxe/MainLoop.hx"
		return wait;
	}
	
	
}


